= To Configure OpenID Connect

If you've already configured your Anypoint Platform as a client application in your identity provider, then follow the steps in link:#manual-client-registration[Manual Registration]. Otherwise, if your identity provider supports it, follow the steps in link:#dynamic-client-registration[Dynamic Client Registration].

== Dynamic Client Registration

Support for Okta and OpenAM Dynamic Client Registration has been verified with the Anypoint Platform.

. Log into the master Organization in Anypoint Platform as Administrator.
. In Anypoint Platform, click Access Management > External Identity.
. From Identity Management, select OpenID Connect.
+
The External Identity - Identity Management OpenID Connect form appears.
+
. Fill in the following required fields after obtaining them from your identity provider’s configuration:
+
* *Client Registration URL*
+
The URL to dynamically register Anypoint as a client application for your identity provider.
+
** Okta: `https://example.okta.com/oauth2/v1/clients` (link:https://developer.okta.com/docs/api/resources/oauth-clients.html#register-new-client[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/connect/register` (link:https://backstage.forgerock.com/docs/openam/13.5/admin-guide#register-openid-connect-client-dynamic[Docs])
+
* *Authorize Header*
+
The authorization header for dynamic client registration request. This is an optional field under the Advanced Settings link. This header is required if the provider restricts registration requests to authorized clients.
+
** Okta: This value will be `SSWS ${api_token}`, where `api_token` is an API token link:https://developer.okta.com/docs/api/getting_started/getting_a_token.html[created through Okta].
+
** OpenAM: This value will be `Bearer ${api_token}`, where `api_token` is an API token link:https://backstage.forgerock.com/docs/openam/13.5/admin-guide#register-openid-connect-client-dynamic[created through OpenAM].
+
* *Authorize URL*
+
The URL where the user authenticates and grants OpenID Connect client applications access to the user's identity.
+
** Okta: `https://example.okta.com/oauth2/v1/authorize` (link:https://developer.okta.com/docs/api/resources/oidc.html#authentication-request[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/authorize` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-oauth2-client-endpoints[Docs])
+
* *Token URL*
+
The URL that provides the user’s identity encoded in a secure JSON Web Token.
+
** Okta: `https://example.okta.com/oauth2/v1/token` (link:https://developer.okta.com/docs/api/resources/oidc.html#token-request[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/access_token` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-oauth2-client-endpoints[Docs])
+
* **User Info URL**
+
The URL that returns user profile information to Anypoint.
+
** Okta: `https://example.okta.com/oauth2/v1/userinfo` (link:https://developer.okta.com/docs/api/resources/oidc.html#get-user-information[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/userinfo` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-openid-connect-authorization[Docs])
+
. Save your configuration.
+
. Sign out and navigate to your organization’s SSO URL, e.g. https://anypoint.mulesoft.com/accounts/login/{yourOrgDomain}, and sign in via your identity provider to test the configuration.

== Manual Client Registration

Support for clients manually created in Okta, OpenAM, and PingFederate has been verified with the Anypoint Platform.

. Log into the master Organization in Anypoint Platform as Administrator.
. In Anypoint Platform, click Access Management > External Identity.
. From Identity Management, select OpenID Connect.
+
The External Identity - Identity Management OpenID Connect form appears.
+
. Click on the `Use manual registration` link under the Client Registration URL field.
. **Before proceeding further, create a client application for the Anypoint Platform inside your Identity Provider.**
** Your Identity Provider will require a redirect URI for redirecting authenticated users. Use the automatically generated redirect URI above the Client ID field for this.
** Inside your Identity Provider, ensure that your client's supported scopes include `openid`, `profile`, and `email`.
** Inside your Identity Provider, ensure that your client uses the `authorization_code` grant type.
** Store your Client ID and Client Secret values in a secure place. You will need them for the next fields inside the Identity Management OpenID Connect form.
. Fill in the following required fields after obtaining them from your identity provider’s configuration:
+
* *Client ID*
+
The unique identifier that you provided for your manually created client application.
+
* *Client Secret*
+
The password, or secret, for authenticating your Anypoint Platform client application with your Identity Provider.
+
* *Authorize URL*
+
The URL where the user authenticates and grants OpenID Connect client applications access to the user's identity.
+
** Okta: `https://example.okta.com/oauth2/v1/authorize` (link:https://developer.okta.com/docs/api/resources/oidc.html#authentication-request[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/authorize` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-oauth2-client-endpoints[Docs])
+
** PingFederate: `https://example.com:9031/as/authorization.oauth2` (link:https://documentation.pingidentity.com/pingfederate/pf84/index.shtml#concept_authorizationEndpoint.html#concept_authorizationEndpoint[Docs])
+
* *Token URL*
+
The URL that provides the user’s identity encoded in a secure JSON Web Token.
+
** Okta: `https://example.okta.com/oauth2/v1/token` (link:https://developer.okta.com/docs/api/resources/oidc.html#token-request[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/access_token` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-oauth2-client-endpoints[Docs])
+
** PingFederate: `https://example.com:9031/as/token.oauth2` (link:https://documentation.pingidentity.com/pingfederate/pf84/index.shtml#adminGuide/concept/tokenEndpoint.html[Docs])
+
* **User Info URL**
+
The URL that returns user profile information to Anypoint.
+
** Okta: `https://example.okta.com/oauth2/v1/userinfo` (link:https://developer.okta.com/docs/api/resources/oidc.html#get-user-information[Docs])
+
** OpenAM: `https://example.com/openam/oauth2/userinfo` (link:https://backstage.forgerock.com/docs/openam/13.5/dev-guide#rest-api-openid-connect-authorization[Docs])
+
** PingFederate: `https://example.com:9031/idp/userinfo.openid` (link:https://developer.pingidentity.com/en/resources/openid-connect-developers-guide.html#userinfo_endpoint[Docs])
+
. Save your configuration.
+
. Sign out and navigate to your organization’s SSO URL, e.g. https://anypoint.mulesoft.com/accounts/login/{yourOrgDomain}, and sign in via your identity provider to test the configuration.
